<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classeur Virtuel - Pokémon Community</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
        }
        .collection-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .collection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            color: #fbbf24;
            transform: translateY(-2px);
        }
        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .search-input:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }
        .filter-button {
            transition: all 0.3s ease;
        }
        .filter-button.active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }
        .collection-stats {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .card-quantity {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .rarity-common { background: linear-gradient(135deg, #6b7280, #4b5563); }
        .rarity-uncommon { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .rarity-rare { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .rarity-mythic { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .rarity-secret { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-slate-900/80 backdrop-blur-md border-b border-slate-700/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-bolt text-white text-sm"></i>
                    </div>
                    <span class="text-xl font-bold text-white">Pokémon Community</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-slate-300 hover:text-white font-medium">Accueil</a>
                    <a href="test.html" class="nav-link text-slate-300 hover:text-white font-medium">Sailor Mélo</a>
                    <a href="pokedex.html" class="nav-link text-slate-300 hover:text-white font-medium">Pokédex</a>
                    <a href="dresseurs.html" class="nav-link text-slate-300 hover:text-white font-medium">Dresseurs</a>
                    <a href="forum.html" class="nav-link text-slate-300 hover:text-white font-medium">Forum</a>
                    <a href="calendrier.html" class="nav-link text-slate-300 hover:text-white font-medium">Calendrier</a>
                    <a href="quiz.html" class="nav-link text-slate-300 hover:text-white font-medium">Quiz</a>
                    <a href="estimateur.html" class="nav-link text-slate-300 hover:text-white font-medium">Estimateur</a>
                    <a href="collection.html" class="nav-link text-white font-medium">Classeur</a>
                    <a href="wishlist.html" class="nav-link text-slate-300 hover:text-white font-medium">Wishlist</a>
                </div>
                <div class="md:hidden">
                    <button class="text-white">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-24 pb-12 bg-gradient-to-br from-slate-800/50 to-slate-900/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-black text-white mb-6">
                    <span class="bg-gradient-to-r from-purple-400 via-pink-500 to-red-500 bg-clip-text text-transparent">
                        Classeur
                    </span>
                    <span class="text-white"> Virtuel</span>
                </h1>
                <p class="text-xl text-slate-300 max-w-3xl mx-auto">Gérez votre collection de cartes Pokémon TCG, suivez leur valeur et organisez votre classeur virtuel</p>
            </div>
            
            <!-- Collection Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="collection-stats rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-white" id="total-cards">0</div>
                    <div class="text-slate-400 text-sm">Total Cartes</div>
                </div>
                <div class="collection-stats rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-green-400" id="total-value">$0.00</div>
                    <div class="text-slate-400 text-sm">Valeur Totale</div>
                </div>
                <div class="collection-stats rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-blue-400" id="unique-cards">0</div>
                    <div class="text-slate-400 text-sm">Cartes Uniques</div>
                </div>
                <div class="collection-stats rounded-xl p-4 text-center">
                    <div class="text-2xl font-bold text-purple-400" id="complete-sets">0</div>
                    <div class="text-slate-400 text-sm">Sets Complets</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Controls Section -->
    <section class="py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row gap-6 items-center justify-between">
                <!-- Search -->
                <div class="flex-1 max-w-md">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="card-search" 
                            placeholder="Rechercher une carte..."
                            class="search-input w-full py-3 px-4 pr-10 rounded-xl text-white placeholder-slate-400 focus:outline-none"
                            oninput="filterCollection()"
                        >
                        <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="flex flex-wrap gap-2">
                    <button onclick="filterByRarity('all')" class="filter-button active px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Tous</button>
                    <button onclick="filterByRarity('Common')" class="filter-button px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Common</button>
                    <button onclick="filterByRarity('Uncommon')" class="filter-button px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Uncommon</button>
                    <button onclick="filterByRarity('Rare')" class="filter-button px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Rare</button>
                    <button onclick="filterByRarity('Mythic')" class="filter-button px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Mythic</button>
                    <button onclick="filterByRarity('Secret')" class="filter-button px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 text-white">Secret</button>
                </div>
                
                <!-- Add Card Button -->
                <button onclick="showAddCardModal()" class="px-6 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold rounded-lg transition-all transform hover:scale-105">
                    <i class="fas fa-plus mr-2"></i>Ajouter Carte
                </button>
            </div>
        </div>
    </section>

    <!-- Collection Grid -->
    <section class="py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Loading State -->
            <div id="loading-state" class="text-center py-12 hidden">
                <i class="fas fa-spinner loading-spinner text-4xl text-yellow-400 mb-4"></i>
                <p class="text-white text-lg">Chargement de votre collection...</p>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="text-center py-12 hidden">
                <i class="fas fa-folder-open text-4xl text-slate-400 mb-4"></i>
                <h3 class="text-white text-xl font-bold mb-2">Votre collection est vide</h3>
                <p class="text-slate-400 mb-6">Commencez par ajouter vos premières cartes Pokémon !</p>
                <button onclick="showAddCardModal()" class="px-6 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold rounded-lg transition-all transform hover:scale-105">
                    <i class="fas fa-plus mr-2"></i>Ajouter ma première carte
                </button>
            </div>

            <!-- Collection Grid -->
            <div id="collection-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Collection cards will be populated here -->
            </div>
        </div>
    </section>

    <!-- Add Card Modal -->
    <div id="add-card-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="collection-card rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">Ajouter une carte</h2>
                    <button onclick="closeAddCardModal()" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Search Card to Add -->
                <div class="mb-6">
                    <label class="block text-slate-300 text-sm font-medium mb-2">Rechercher une carte</label>
                    <div class="relative">
                        <input 
                            type="text" 
                            id="add-card-search" 
                            placeholder="Nom de la carte..."
                            class="search-input w-full py-3 px-4 pr-10 rounded-xl text-white placeholder-slate-400 focus:outline-none"
                            oninput="searchCardsToAdd()"
                        >
                        <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
                    </div>
                </div>
                
                <!-- Search Results -->
                <div id="add-search-results" class="mb-6 max-h-60 overflow-y-auto hidden">
                    <!-- Search results will be populated here -->
                </div>
                
                <!-- Selected Card Details -->
                <div id="selected-card-details" class="hidden">
                    <div class="flex items-start space-x-4 mb-6">
                        <img id="selected-card-image" src="" alt="" class="w-32 h-auto rounded-lg">
                        <div>
                            <h3 id="selected-card-name" class="text-white font-bold text-xl mb-2"></h3>
                            <p id="selected-card-set" class="text-slate-400 mb-1"></p>
                            <p id="selected-card-rarity" class="text-slate-400"></p>
                        </div>
                    </div>
                    
                    <!-- Card Condition -->
                    <div class="mb-4">
                        <label class="block text-slate-300 text-sm font-medium mb-2">État de la carte</label>
                        <select id="card-condition" class="w-full py-2 px-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-yellow-400">
                            <option value="mint">Mint (Parfait état)</option>
                            <option value="near-mint">Near Mint (Quasi parfait)</option>
                            <option value="excellent">Excellent (Très bon état)</option>
                            <option value="good">Good (Bon état)</option>
                            <option value="light-played">Light Played (Légère usure)</option>
                            <option value="played">Played (Usure visible)</option>
                            <option value="poor">Poor (Mauvais état)</option>
                        </select>
                    </div>
                    
                    <!-- Card Quantity -->
                    <div class="mb-6">
                        <label class="block text-slate-300 text-sm font-medium mb-2">Quantité</label>
                        <div class="flex items-center space-x-3">
                            <button onclick="changeQuantity(-1)" class="w-10 h-10 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" id="card-quantity" value="1" min="1" max="99" class="w-20 py-2 px-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-center focus:outline-none focus:border-yellow-400">
                            <button onclick="changeQuantity(1)" class="w-10 h-10 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Add Button -->
                    <button onclick="addSelectedCard()" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white font-bold rounded-lg transition-all transform hover:scale-105">
                        <i class="fas fa-plus mr-2"></i>Ajouter à ma collection
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-700 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-2 mb-4">
                    <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-bolt text-white text-sm"></i>
                    </div>
                    <span class="text-2xl font-bold text-white">Pokémon Community</span>
                </div>
                <p class="text-slate-400 mb-6">La communauté ultime pour les fans de Pokémon</p>
                <div class="flex justify-center space-x-6 mb-6">
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-discord text-xl"></i>
                    </a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-youtube text-xl"></i>
                    </a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-instagram text-xl"></i>
                    </a>
                </div>
                <p class="text-slate-500 text-sm">© 2025 Pokémon Community. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <script>
        let collection = JSON.parse(localStorage.getItem('pokemon_collection') || '[]');
        let filteredCollection = [...collection];
        let currentFilter = 'all';
        let selectedCard = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            displayCollection();
            
            // Close modal when clicking outside
            document.getElementById('add-card-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAddCardModal();
                }
            });
        });

        function updateStats() {
            const totalCards = collection.reduce((sum, card) => sum + (card.quantity || 1), 0);
            const uniqueCards = collection.length;
            const totalValue = collection.reduce((sum, card) => sum + (card.estimatedValue * (card.quantity || 1)), 0);
            const completeSets = calculateCompleteSets();

            document.getElementById('total-cards').textContent = totalCards;
            document.getElementById('unique-cards').textContent = uniqueCards;
            document.getElementById('total-value').textContent = `$${totalValue.toFixed(2)}`;
            document.getElementById('complete-sets').textContent = completeSets;
        }

        function calculateCompleteSets() {
            // Mock calculation - in real app would check set completion
            return Math.floor(collection.length / 50);
        }

        function displayCollection() {
            const grid = document.getElementById('collection-grid');
            const emptyState = document.getElementById('empty-state');

            if (filteredCollection.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            
            grid.innerHTML = filteredCollection.map((card, index) => {
                const rarityClass = getRarityClass(card.rarity);
                
                return `
                    <div class="collection-card rounded-2xl p-4 fade-in cursor-pointer" 
                         style="animation-delay: ${index * 0.05}s"
                         onclick="showCardDetails('${card.id}')">
                        
                        <!-- Card Image -->
                        <div class="relative mb-3">
                            <img src="${card.image}" 
                                 alt="${card.name}" 
                                 class="w-full h-auto rounded-lg shadow-lg"
                                 onerror="this.src='https://via.placeholder.com/245x342/1e293b/ffffff?text=${encodeURIComponent(card.name)}'">
                            <div class="absolute top-2 right-2">
                                <span class="card-quantity text-white text-xs font-bold px-2 py-1 rounded-full">
                                    ${card.quantity || 1}
                                </span>
                            </div>
                            <div class="absolute top-2 left-2">
                                <span class="px-2 py-1 ${rarityClass} text-white text-xs font-semibold rounded">
                                    ${card.rarity || 'Unknown'}
                                </span>
                            </div>
                        </div>
                        
                        <!-- Card Info -->
                        <div class="space-y-2">
                            <h3 class="text-white font-bold text-lg truncate">${card.name}</h3>
                            <div class="text-slate-400 text-sm">
                                <div class="flex justify-between">
                                    <span>Set:</span>
                                    <span class="truncate">${card.set || 'Unknown'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Condition:</span>
                                    <span>${getConditionText(card.condition)}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Valeur:</span>
                                    <span class="text-green-400 font-semibold">$${(card.estimatedValue || 0).toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Actions -->
                        <div class="absolute bottom-2 right-2 flex space-x-1">
                            <button onclick="event.stopPropagation(); editCard('${card.id}')" class="text-slate-400 hover:text-yellow-400 transition-colors">
                                <i class="fas fa-edit text-sm"></i>
                            </button>
                            <button onclick="event.stopPropagation(); removeCard('${card.id}')" class="text-slate-400 hover:text-red-400 transition-colors">
                                <i class="fas fa-trash text-sm"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getRarityClass(rarity) {
            const rarityMap = {
                'Common': 'rarity-common',
                'Uncommon': 'rarity-uncommon',
                'Rare': 'rarity-rare',
                'Rare Holo': 'rarity-rare',
                'Rare Holo EX': 'rarity-mythic',
                'Rare Holo GX': 'rarity-mythic',
                'Rare Holo V': 'rarity-mythic',
                'Rare Holo VMAX': 'rarity-mythic',
                'Rare Rainbow': 'rarity-secret',
                'Rare Secret': 'rarity-secret',
                'Rare Ultra': 'rarity-secret',
                'Illustration Rare': 'rarity-secret',
                'Special Illustration Rare': 'rarity-secret',
                'Hyper Rare': 'rarity-secret',
                'Amazing Rare': 'rarity-secret'
            };
            return rarityMap[rarity] || 'rarity-common';
        }

        function getConditionText(condition) {
            const conditions = {
                'mint': 'Mint',
                'near-mint': 'NM',
                'excellent': 'EX',
                'good': 'GD',
                'light-played': 'LP',
                'played': 'PL',
                'poor': 'PR'
            };
            return conditions[condition] || 'Unknown';
        }

        function filterByRarity(rarity) {
            currentFilter = rarity;
            
            // Update filter buttons
            document.querySelectorAll('.filter-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter collection
            if (rarity === 'all') {
                filteredCollection = [...collection];
            } else {
                filteredCollection = collection.filter(card => card.rarity === rarity);
            }
            
            displayCollection();
        }

        function filterCollection() {
            const searchTerm = document.getElementById('card-search').value.toLowerCase();
            
            if (currentFilter === 'all' && !searchTerm) {
                filteredCollection = [...collection];
            } else {
                filteredCollection = collection.filter(card => {
                    const matchesSearch = !searchTerm || 
                        card.name.toLowerCase().includes(searchTerm) ||
                        card.set.toLowerCase().includes(searchTerm);
                    
                    const matchesRarity = currentFilter === 'all' || card.rarity === currentFilter;
                    
                    return matchesSearch && matchesRarity;
                });
            }
            
            displayCollection();
        }

        function showAddCardModal() {
            document.getElementById('add-card-modal').classList.remove('hidden');
            document.getElementById('add-card-search').focus();
        }

        function closeAddCardModal() {
            document.getElementById('add-card-modal').classList.add('hidden');
            document.getElementById('add-card-search').value = '';
            document.getElementById('add-search-results').innerHTML = '';
            document.getElementById('add-search-results').classList.add('hidden');
            document.getElementById('selected-card-details').classList.add('hidden');
            selectedCard = null;
        }

        async function searchCardsToAdd() {
            const searchTerm = document.getElementById('add-card-search').value.trim();
            const resultsContainer = document.getElementById('add-search-results');
            
            if (!searchTerm) {
                resultsContainer.classList.add('hidden');
                return;
            }

            try {
                const response = await fetch(`https://api.pokemontcg.io/v2/cards?q=name:${encodeURIComponent(searchTerm)}*&pageSize=20`, {
                    headers: { 'Accept': 'application/json' }
                });

                if (!response.ok) throw new Error('API error');

                const data = await response.json();
                const cards = data.data || [];

                if (cards.length > 0) {
                    resultsContainer.innerHTML = cards.map(card => `
                        <div class="flex items-center space-x-3 p-3 hover:bg-slate-700 rounded-lg cursor-pointer transition-colors"
                             onclick="selectCardToAdd('${card.id}', '${card.name}', '${card.images?.small || card.images?.large}', '${card.set?.name}', '${card.rarity}')">
                            <img src="${card.images?.small || card.images?.large}" alt="${card.name}" class="w-12 h-auto rounded">
                            <div class="flex-1">
                                <div class="text-white font-medium">${card.name}</div>
                                <div class="text-slate-400 text-sm">${card.set?.name} • ${card.rarity || 'Unknown'}</div>
                            </div>
                        </div>
                    `).join('');
                    resultsContainer.classList.remove('hidden');
                } else {
                    resultsContainer.classList.add('hidden');
                }
            } catch (error) {
                console.error('Error searching cards:', error);
                resultsContainer.classList.add('hidden');
            }
        }

        function selectCardToAdd(id, name, image, set, rarity) {
            selectedCard = { id, name, image, set, rarity };
            
            document.getElementById('selected-card-image').src = image;
            document.getElementById('selected-card-name').textContent = name;
            document.getElementById('selected-card-set').textContent = set;
            document.getElementById('selected-card-rarity').textContent = rarity || 'Unknown';
            
            document.getElementById('add-search-results').classList.add('hidden');
            document.getElementById('selected-card-details').classList.remove('hidden');
        }

        function changeQuantity(delta) {
            const quantityInput = document.getElementById('card-quantity');
            const newQuantity = Math.max(1, Math.min(99, parseInt(quantityInput.value) + delta));
            quantityInput.value = newQuantity;
        }

        function addSelectedCard() {
            if (!selectedCard) return;

            const condition = document.getElementById('card-condition').value;
            const quantity = parseInt(document.getElementById('card-quantity').value);
            
            // Calculate estimated value based on rarity and condition
            const estimatedValue = calculateCardValue(selectedCard.rarity, condition);
            
            // Check if card already exists in collection
            const existingCardIndex = collection.findIndex(card => card.id === selectedCard.id && card.condition === condition);
            
            if (existingCardIndex !== -1) {
                // Update quantity
                collection[existingCardIndex].quantity += quantity;
            } else {
                // Add new card
                collection.push({
                    ...selectedCard,
                    condition,
                    quantity,
                    estimatedValue,
                    dateAdded: new Date().toISOString()
                });
            }
            
            // Save to localStorage
            localStorage.setItem('pokemon_collection', JSON.stringify(collection));
            
            // Update display
            updateStats();
            filterCollection();
            closeAddCardModal();
            
            // Show success message
            showNotification('Carte ajoutée à votre collection !', 'success');
        }

        function calculateCardValue(rarity, condition) {
            const basePrices = {
                'Common': 0.25,
                'Uncommon': 0.50,
                'Rare': 2.00,
                'Rare Holo': 5.00,
                'Rare Holo EX': 15.00,
                'Rare Holo GX': 20.00,
                'Rare Holo V': 25.00,
                'Rare Holo VMAX': 35.00,
                'Rare Rainbow': 50.00,
                'Rare Secret': 75.00,
                'Rare Ultra': 100.00,
                'Illustration Rare': 150.00,
                'Special Illustration Rare': 200.00,
                'Hyper Rare': 300.00,
                'Amazing Rare': 250.00
            };

            const conditionMultiplier = {
                'mint': 1.2,
                'near-mint': 1.0,
                'excellent': 0.9,
                'good': 0.8,
                'light-played': 0.7,
                'played': 0.6,
                'poor': 0.4
            };

            const basePrice = basePrices[rarity] || 0.50;
            const multiplier = conditionMultiplier[condition] || 1.0;
            
            return basePrice * multiplier;
        }

        function removeCard(cardId) {
            if (confirm('Êtes-vous sûr de vouloir retirer cette carte de votre collection ?')) {
                collection = collection.filter(card => card.id !== cardId);
                localStorage.setItem('pokemon_collection', JSON.stringify(collection));
                updateStats();
                filterCollection();
                showNotification('Carte retirée de votre collection', 'success');
            }
        }

        function showCardDetails(cardId) {
            // This would show a detailed view of the card
            // For now, just show a notification
            showNotification('Fonctionnalité de détails en cours de développement', 'info');
        }

        function editCard(cardId) {
            // This would open an edit modal
            showNotification('Fonctionnalité d\'édition en cours de développement', 'info');
        }

        function showNotification(message, type = 'info') {
            // Simple notification system
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium transition-all duration-300 transform translate-x-full`;
            
            const colors = {
                'success': 'bg-green-500',
                'error': 'bg-red-500',
                'info': 'bg-blue-500',
                'warning': 'bg-yellow-500'
            };
            
            notification.classList.add(colors[type] || colors.info);
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animate out and remove
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>