<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dresseurs Emblématiques - Pokémon Community</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
        }
        .trainer-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .trainer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            color: #fbbf24;
            transform: translateY(-2px);
        }
        .generation-tab {
            transition: all 0.3s ease;
        }
        .generation-tab.active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }
        .tcg-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .tcg-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        .scroll-reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }
        .scroll-reveal.revealed {
            opacity: 1;
            transform: translateY(0);
        }
        .lore-section {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #fbbf24;
        }
        .anecdote-item {
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid #3b82f6;
        }
        .trainer-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #fbbf24;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .trainer-avatar-large {
            width: 112px;
            height: 112px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #fcd34d;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        .badge-role {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1e293b;
            font-size: 0.75rem;
            font-weight: bold;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .badge-specialty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .favorite-btn {
            background: transparent;
            border: none;
            color: #fbbf24;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s ease, color 0.2s ease;
        }
        .favorite-btn:hover {
            transform: scale(1.2);
        }
        .favorite-btn.active {
            color: #fbbf24;
        }
        .favorite-btn:not(.active) {
            color: #64748b;
        }
        .social-links {
            display: flex;
            gap: 0.75rem;
            margin-top: 0.5rem;
            justify-content: center;
        }
        .social-link {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .social-link:hover {
            background: rgba(251, 191, 36, 0.3);
            transform: translateY(-2px);
        }
        .profile-transition {
            animation: fadeInSlide 0.4s ease-out;
        }
        @keyframes fadeInSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Modal pour agrandir les cartes TCG */
        .card-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(5, 8, 22, 0.85);
            backdrop-filter: blur(14px);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
            z-index: 1000;
        }

        .card-modal-overlay.is-open {
            opacity: 1;
            pointer-events: auto;
        }

        .card-modal {
            position: relative;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 24px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
            max-width: 90vw;
            max-height: 90vh;
            padding: 1.5rem 1.8rem;
            display: grid;
            grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
            gap: 1.5rem;
            transform: translateY(10px) scale(0.94);
            opacity: 0;
            transition: transform 0.25s ease, opacity 0.25s ease;
        }

        .card-modal-overlay.is-open .card-modal {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .card-modal-image-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-modal-img {
            max-width: 90vw;
            max-height: 80vh;
            width: 100%;
            height: auto;
            object-fit: contain;
            border-radius: 18px;
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
        }

        .card-modal-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0.75rem;
        }

        .card-modal-title {
            margin: 0;
            font-size: 1.4rem;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: white;
        }

        .card-modal-meta {
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .card-modal-chip {
            padding: 0.3rem 0.8rem;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: rgba(226, 232, 240, 0.9);
        }

        .card-modal-close {
            position: absolute;
            top: 0.6rem;
            right: 0.9rem;
            background: transparent;
            border: none;
            color: rgba(226, 232, 240, 0.85);
            font-size: 1.8rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            transition: transform 0.2s ease, color 0.2s ease;
            z-index: 10;
        }

        .card-modal-close:hover {
            transform: scale(1.15);
            color: #f97373;
        }

        @media (max-width: 768px) {
            .card-modal {
                grid-template-columns: minmax(0, 1fr);
                padding: 1.2rem 1.1rem 1.4rem;
            }

            .card-modal-img {
                max-height: 60vh;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-slate-900/80 backdrop-blur-md border-b border-slate-700/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-bolt text-white text-sm"></i>
                    </div>
                    <span class="text-xl font-bold text-white">Pokémon Community</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-slate-300 hover:text-white font-medium">Accueil</a>
                    <a href="index.html" class="nav-link text-slate-300 hover:text-white font-medium">Sailor Mélo</a>
                    <a href="pokedex.html" class="nav-link text-slate-300 hover:text-white font-medium">Pokédex</a>
                    <a href="dresseurs.html" class="nav-link text-white font-medium">Dresseurs</a>
                    <a href="forum.html" class="nav-link text-slate-300 hover:text-white font-medium">Forum</a>
                    <a href="calendrier.html" class="nav-link text-slate-300 hover:text-white font-medium">Calendrier</a>
                    <a href="quiz.html" class="nav-link text-slate-300 hover:text-white font-medium">Quiz</a>
                    <a href="estimateur.html" class="nav-link text-slate-300 hover:text-white font-medium">Estimateur</a>
                    <a href="collection.html" class="nav-link text-slate-300 hover:text-white font-medium">Classeur</a>
                    <a href="wishlist.html" class="nav-link text-slate-300 hover:text-white font-medium">Wishlist</a>
                </div>
                <div class="md:hidden">
                    <button class="text-white">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-24 pb-12 bg-gradient-to-b from-slate-900 to-slate-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-5xl md:text-7xl font-black text-white mb-6">
                <span class="bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 bg-clip-text text-transparent">
                    Dresseurs Emblématiques
                </span>
            </h1>
            <p class="text-xl text-slate-300 max-w-3xl mx-auto">
                Découvrez l'histoire, le lore et les anecdotes des dresseurs légendaires de chaque génération Pokémon
            </p>
        </div>
    </section>

    <!-- Generation Tabs -->
    <section class="py-8 bg-slate-800/50 sticky top-16 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="showGeneration(1)" class="generation-tab active px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 1 - Kanto
                </button>
                <button onclick="showGeneration(2)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 2 - Johto
                </button>
                <button onclick="showGeneration(3)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 3 - Hoenn
                </button>
                <button onclick="showGeneration(4)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 4 - Sinnoh
                </button>
                <button onclick="showGeneration(5)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 5 - Unys
                </button>
                <button onclick="showGeneration(6)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 6 - Kalos
                </button>
                <button onclick="showGeneration(7)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 7 - Alola
                </button>
                <button onclick="showGeneration(8)" class="generation-tab px-6 py-3 rounded-full text-white font-semibold bg-slate-700 hover:bg-slate-600">
                    Génération 8 - Galar
                </button>
            </div>
        </div>
    </section>

    <!-- Trainers Content -->
    <section class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Barre de recherche -->
            <div class="my-6 text-center">
                <input
                    id="trainer-search"
                    class="px-5 py-3 rounded-full border border-slate-400 focus:border-yellow-500 outline-none w-full max-w-md shadow-md text-lg bg-slate-800 text-white placeholder-slate-400"
                    type="search"
                    placeholder="Rechercher un dresseur, ville ou rôle..."
                    autocomplete="off"
                />
            </div>
            <div id="trainers-content">
                <!-- Content will be dynamically loaded -->
            </div>
        </div>
    </section>

    <!-- Modal pour agrandir les cartes TCG -->
    <div id="card-modal-overlay" class="card-modal-overlay">
        <div class="card-modal" role="dialog" aria-modal="true" aria-labelledby="card-modal-name">
            <button id="card-modal-close" class="card-modal-close" aria-label="Fermer la carte">×</button>

            <div class="card-modal-image-wrapper">
                <img id="card-modal-img" class="card-modal-img" src="" alt="Carte Pokémon agrandie" loading="lazy">
            </div>

            <div class="card-modal-info">
                <h2 id="card-modal-name" class="card-modal-title">Nom de la carte</h2>
                <p class="card-modal-meta">
                    <span id="card-modal-set" class="card-modal-chip">Set inconnu</span>
                    <span id="card-modal-rarity" class="card-modal-chip">Rareté inconnue</span>
                </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-700 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-2 mb-4">
                    <div class="w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-bolt text-white text-sm"></i>
                    </div>
                    <span class="text-2xl font-bold text-white">Pokémon Community</span>
                </div>
                <p class="text-slate-400 mb-6">La communauté ultime pour les fans de Pokémon</p>
                <p class="text-slate-500 text-sm">© 2025 Pokémon Community. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <script>
        // Database des dresseurs par génération
        const trainersDatabase = {
            1: [
                {
                    name: "Professeur Chen",
                    nameEN: "Professor Oak",
                    avatar: "assets/img/dresseurs/professeur-chen.png",
                    role: "Chercheur Pokémon",
                    location: "Bourg Palette",
                    specialty: "Recherche Pokémon",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Le Professeur Chen est le chercheur Pokémon le plus respecté de la région de Kanto. Il a consacré sa vie à l'étude des Pokémon et offre aux jeunes dresseurs leur premier Pokémon. Il est également le grand-père de Régis, le rival du protagoniste.",
                    lore: "Le Professeur Chen est connu pour son Pokédex, un appareil révolutionnaire qui enregistre les données de tous les Pokémon rencontrés. Il a été le mentor de nombreux dresseurs légendaires et continue d'aider les nouvelles générations à comprendre le monde des Pokémon.",
                    anecdotes: [
                        "Le Professeur Chen a été le premier à créer le système de Pokédex électronique.",
                        "Il a découvert plusieurs espèces de Pokémon rares dans la région de Kanto.",
                        "Dans les jeux, il offre le choix entre Bulbizarre, Salamèche et Carapuce.",
                        "Il est souvent considéré comme le père de la recherche Pokémon moderne."
                    ],
                    tcgCards: ["Professor Oak", "Professor Oak's Research", "Professor Oak's Setup"]
                },
                {
                    name: "Pierre",
                    nameEN: "Brock",
                    avatar: "assets/img/dresseurs/pierre.png",
                    role: "Champion d'Arène",
                    location: "Argenta",
                    specialty: "Pokémon de type Roche",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Pierre est le Champion d'Arène d'Argenta, spécialisé dans les Pokémon de type Roche. Il est également un excellent cuisinier et prend soin de ses nombreux frères et sœurs. Il rêve de devenir le meilleur éleveur de Pokémon au monde.",
                    lore: "Pierre est connu pour sa passion pour les roches et les fossiles. Il a une connaissance approfondie des Pokémon de type Roche et peut identifier n'importe quelle pierre précieuse. Malgré sa jeunesse, il est très responsable et mature.",
                    anecdotes: [
                        "Pierre a 9 frères et sœurs qu'il élève seul depuis la disparition de son père.",
                        "Il est un expert en cuisine Pokémon et prépare des repas nutritifs.",
                        "Dans l'anime, il voyage avec Sacha et Ondine pendant plusieurs saisons.",
                        "Il a un Onix et un Golem dans son équipe principale."
                    ],
                    tcgCards: ["Brock", "Brock's Grit", "Brock's Training Method"]
                },
                {
                    name: "Ondine",
                    nameEN: "Misty",
                    avatar: "assets/img/dresseurs/ondine.png",
                    role: "Championne d'Arène",
                    location: "Azuria",
                    specialty: "Pokémon de type Eau",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Ondine est la Championne d'Arène d'Azuria, spécialisée dans les Pokémon de type Eau. Elle est énergique, déterminée et a un fort caractère. Elle a une passion pour les Pokémon aquatiques et rêve de devenir Maître Pokémon.",
                    lore: "Ondine est la plus jeune des quatre sœurs qui dirigent l'Arène d'Azuria. Elle est souvent frustrée par ses sœurs qui préfèrent la beauté à la force. Elle a un lien spécial avec ses Pokémon de type Eau, notamment son Lézardou.",
                    anecdotes: [
                        "Ondine a un Lézardou qui refuse d'évoluer en Lézard.",
                        "Elle déteste les Pokémon de type Insecte et Plante.",
                        "Dans l'anime, elle voyage avec Sacha et Pierre pendant plusieurs saisons.",
                        "Elle est une excellente nageuse et peut rester sous l'eau très longtemps."
                    ],
                    tcgCards: ["Misty", "Misty's Determination", "Misty's Favor"]
                },
                {
                    name: "Régis",
                    nameEN: "Gary Oak",
                    avatar: "assets/img/dresseurs/regis.png",
                    role: "Rival",
                    location: "Bourg Palette",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Régis est le petit-fils du Professeur Chen et le rival principal du protagoniste. Au début, il est arrogant et méprisant, mais il évolue au fil de l'aventure pour devenir un dresseur respectueux et puissant.",
                    lore: "Régis commence son aventure avec un Pokémon de type différent de celui du protagoniste. Il collectionne rapidement 10 badges et devient un chercheur Pokémon, suivant les traces de son grand-père. Il finit par comprendre que la force ne vient pas seulement de la puissance, mais aussi du lien avec ses Pokémon.",
                    anecdotes: [
                        "Régis a une voiture de sport et un groupe de filles qui le suivent partout.",
                        "Il collectionne les badges plus rapidement que le protagoniste.",
                        "Il devient chercheur Pokémon après sa défaite contre le protagoniste.",
                        "Il a un Évoli qui évolue en Aquali dans certains jeux."
                    ],
                    tcgCards: ["Gary"]
                }
            ],
            2: [
                {
                    name: "Jasmine",
                    nameEN: "Jasmine",
                    avatar: "assets/img/dresseurs/jasmine.png",
                    role: "Championne d'Arène",
                    location: "Oliville",
                    specialty: "Pokémon de type Acier",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Jasmine est la Championne d'Arène d'Oliville, spécialisée dans les Pokémon de type Acier. Elle est douce, timide mais très déterminée. Elle a un lien spécial avec les Pokémon de type Acier, notamment son Magnéti.",
                    lore: "Jasmine est connue pour sa gentillesse et sa patience. Elle prend soin des Pokémon malades et blessés. Elle a découvert sa passion pour les Pokémon de type Acier en soignant un Magnéti malade. Elle est également une excellente amie avec le Professeur Orme.",
                    anecdotes: [
                        "Jasmine a un Magnéti qui était malade et qu'elle a soigné avec amour.",
                        "Elle est très timide mais devient confiante lorsqu'elle combat.",
                        "Elle est la seule Championne d'Arène de Johto spécialisée dans un seul type.",
                        "Dans certains jeux, elle aide le protagoniste à soigner un Pokémon malade."
                    ],
                    tcgCards: ["Jasmine"]
                },
                {
                    name: "Silver",
                    nameEN: "Silver",
                    avatar: "assets/img/dresseurs/silver.png",
                    role: "Rival",
                    location: "Johto",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Silver est le rival du protagoniste dans les jeux de la génération 2. Il est initialement arrogant et cruel envers les Pokémon, mais il évolue au fil de l'aventure pour comprendre l'importance du lien entre dresseur et Pokémon.",
                    lore: "Silver est en fait le fils de Giovanni, le leader de la Team Rocket. Il a été abandonné par son père et a développé une haine envers les dresseurs qui maltraitent leurs Pokémon. Il finit par comprendre que la vraie force vient du respect mutuel.",
                    anecdotes: [
                        "Silver vole un Pokémon au début de l'aventure (un starter).",
                        "Il est le fils de Giovanni, le leader de la Team Rocket.",
                        "Il change d'attitude après avoir été battu plusieurs fois.",
                        "Il finit par libérer son Pokémon volé et en choisit un nouveau."
                    ],
                    tcgCards: []
                }
            ],
            3: [
                {
                    name: "Pierre Rochard",
                    nameEN: "Steven Stone",
                    avatar: "assets/img/dresseurs/pierre-rochard.png",
                    role: "Maître de la Ligue",
                    location: "Pacifidlog",
                    specialty: "Pokémon de type Acier et Roche",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Pierre Rochard est le Maître de la Ligue Pokémon de Hoenn et le fils du président de la Devon Corporation. Il est passionné par les pierres rares et les Pokémon de type Acier. Il est calme, réfléchi et très puissant.",
                    lore: "Pierre Rochard est un collectionneur de pierres rares et un expert en minéralogie. Il voyage à travers Hoenn pour trouver des pierres précieuses et des fossiles. Il a un lien spécial avec son Métalosse, qu'il a trouvé dans une grotte. Il aide le protagoniste à plusieurs reprises dans sa quête.",
                    anecdotes: [
                        "Pierre Rochard est le fils du président de la Devon Corporation.",
                        "Il collectionne les pierres rares et les fossiles.",
                        "Il a un Métalosse qu'il a trouvé dans une grotte.",
                        "Il devient le Maître de la Ligue après avoir battu le précédent champion."
                    ],
                    tcgCards: ["Steven", "Steven's Resolve", "Steven's Advice"]
                },
                {
                    name: "Flora",
                    nameEN: "May",
                    avatar: "assets/img/dresseurs/flora.png",
                    role: "Rivale/Compagne",
                    location: "Bourg-en-Vol",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Flora est la fille du Professeur Seko et la rivale/compagne du protagoniste dans les jeux de Hoenn. Elle est énergique, optimiste et aime voyager. Elle devient une Coordinatrice Pokémon dans l'anime.",
                    lore: "Flora commence son aventure en recevant un Pokémon du Professeur Seko. Elle voyage à travers Hoenn pour devenir une dresseuse accomplie. Dans l'anime, elle se spécialise dans les Concours Pokémon et devient une Coordinatrice talentueuse.",
                    anecdotes: [
                        "Flora est la fille du Professeur Seko.",
                        "Elle devient Coordinatrice Pokémon dans l'anime.",
                        "Elle a un Nénupiot qui évolue en Jugeote.",
                        "Elle est très amie avec le protagoniste et l'aide dans sa quête."
                    ],
                    tcgCards: ["May"]
                }
            ],
            4: [
                {
                    name: "Cynthia",
                    nameEN: "Cynthia",
                    avatar: "assets/img/dresseurs/cynthia.png",
                    role: "Maîtresse de la Ligue",
                    location: "Joliberges",
                    specialty: "Équipe équilibrée",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Cynthia est la Maîtresse de la Ligue Pokémon de Sinnoh, considérée comme l'une des champions les plus puissants de l'histoire. Elle est calme, intelligente et a une connaissance approfondie de la mythologie Pokémon. Elle possède une équipe redoutable et équilibrée.",
                    lore: "Cynthia est une chercheuse passionnée par l'histoire et la mythologie de Sinnoh. Elle étudie les légendes des Pokémon légendaires, notamment Dialga, Palkia et Giratina. Elle aide le protagoniste à comprendre les mystères de la région et à empêcher l'équipe Galaxie de détruire le monde.",
                    anecdotes: [
                        "Cynthia possède un Garchomp, l'un des Pokémon les plus puissants de Sinnoh.",
                        "Elle est considérée comme la championne la plus difficile à battre de toute la série.",
                        "Elle étudie la mythologie Pokémon et connaît les légendes de Sinnoh.",
                        "Elle apparaît dans plusieurs générations suivantes pour aider le protagoniste."
                    ],
                    tcgCards: ["Cynthia", "Cynthia's Ambition", "Cynthia's Feelings", "Cynthia's Guidance"]
                },
                {
                    name: "Aurore",
                    nameEN: "Dawn",
                    avatar: "assets/img/dresseurs/aurore.png",
                    role: "Compagne",
                    location: "Bourg-en-Vol",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Aurore est la compagne du protagoniste dans les jeux de Sinnoh. Elle est énergique, optimiste et rêve de devenir une Coordinatrice Pokémon. Elle voyage à travers Sinnoh pour participer aux Concours Pokémon.",
                    lore: "Aurore commence son aventure en recevant un Pokémon du Professeur Sorbier. Elle se spécialise dans les Concours Pokémon et devient une Coordinatrice talentueuse. Elle a un lien spécial avec son Évoli, qu'elle utilise dans les concours.",
                    anecdotes: [
                        "Aurore est une Coordinatrice Pokémon talentueuse.",
                        "Elle a un Évoli qui peut évoluer en plusieurs formes.",
                        "Elle participe aux Concours Pokémon à travers Sinnoh.",
                        "Elle est très amie avec le protagoniste et l'aide dans sa quête."
                    ],
                    tcgCards: ["Dawn"]
                }
            ],
            5: [
                {
                    name: "Ghetis",
                    nameEN: "Ghetsis",
                    avatar: "assets/img/dresseurs/ghetis.png",
                    role: "Leader de la Team Plasma",
                    location: "Unys",
                    specialty: "Manipulation",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Ghetis est le leader de la Team Plasma, une organisation qui prétend vouloir libérer les Pokémon de leurs dresseurs. En réalité, il manipule N et la Team Plasma pour ses propres objectifs égoïstes. Il est l'un des antagonistes les plus dangereux de la série.",
                    lore: "Ghetis est un manipulateur expert qui utilise la Team Plasma pour voler les Pokémon des dresseurs. Il prétend vouloir libérer les Pokémon, mais en réalité, il veut contrôler tous les Pokémon pour dominer le monde. Il a élevé N depuis l'enfance pour en faire un outil de ses plans.",
                    anecdotes: [
                        "Ghetis est le vrai leader de la Team Plasma, pas N.",
                        "Il a élevé N depuis l'enfance pour en faire un outil.",
                        "Il possède un Hydragon, l'un des Pokémon les plus puissants d'Unys.",
                        "Il est l'un des antagonistes les plus dangereux et manipulateurs de la série."
                    ],
                    tcgCards: ["Ghetsis"]
                },
                {
                    name: "N",
                    nameEN: "N",
                    avatar: "assets/img/dresseurs/n.png",
                    role: "Rival/Protagoniste",
                    location: "Unys",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "N est un personnage complexe qui croit que les Pokémon doivent être libérés de leurs dresseurs. Il est le 'roi' de la Team Plasma, mais il ignore que Ghetis le manipule. Il finit par comprendre la vérité et change d'avis sur le lien entre dresseurs et Pokémon.",
                    lore: "N a été élevé par Ghetis depuis l'enfance et a développé la capacité de communiquer avec les Pokémon. Il croit sincèrement que les Pokémon sont maltraités par les dresseurs, mais il finit par comprendre que le lien entre dresseur et Pokémon peut être bénéfique pour les deux.",
                    anecdotes: [
                        "N peut communiquer avec les Pokémon.",
                        "Il a été élevé par Ghetis depuis l'enfance.",
                        "Il possède un Zekrom ou un Reshiram selon la version du jeu.",
                        "Il finit par comprendre que le lien dresseur-Pokémon peut être positif."
                    ],
                    tcgCards: ["N"]
                }
            ],
            6: [
                {
                    name: "Lysandre",
                    nameEN: "Lysandre",
                    avatar: "assets/img/dresseurs/lysandre.png",
                    role: "Leader de la Team Flare",
                    location: "Kalos",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Lysandre est le leader de la Team Flare, une organisation qui veut créer un 'monde parfait' en éliminant ceux qu'ils considèrent comme indésirables. Il est charismatique, riche et possède une technologie avancée. Il est obsédé par la beauté et la perfection.",
                    lore: "Lysandre est le fondateur de la Team Flare et le propriétaire de la société Lysandre Labs. Il a développé une technologie qui peut contrôler les Pokémon légendaires. Il veut utiliser cette technologie pour créer un monde parfait, mais ses méthodes sont extrêmes et dangereuses.",
                    anecdotes: [
                        "Lysandre est le fondateur de la Team Flare et de Lysandre Labs.",
                        "Il possède une technologie avancée pour contrôler les Pokémon légendaires.",
                        "Il veut créer un 'monde parfait' en éliminant ceux qu'il considère indésirables.",
                        "Il est obsédé par la beauté et la perfection."
                    ],
                    tcgCards: ["Lysandre", "Lysandre's Trump Card"]
                },
                {
                    name: "Sannah",
                    nameEN: "Serena",
                    avatar: "assets/img/dresseurs/sannah.png",
                    role: "Rivale/Compagne",
                    location: "Bourg-en-Vol",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Sannah est la rivale/compagne du protagoniste dans les jeux de Kalos. Elle est énergique, joyeuse et rêve de devenir une dresseuse accomplie. Elle voyage à travers Kalos pour améliorer ses compétences.",
                    lore: "Sannah commence son aventure en recevant un Pokémon du Professeur Platane. Elle voyage à travers Kalos pour devenir une dresseuse accomplie. Dans l'anime, elle devient une Performeuse Pokémon et participe aux Spectacles Pokémon.",
                    anecdotes: [
                        "Sannah est une Performeuse Pokémon dans l'anime.",
                        "Elle participe aux Spectacles Pokémon à travers Kalos.",
                        "Elle a un Félinferno qu'elle utilise dans les spectacles.",
                        "Elle est très amie avec le protagoniste et l'aide dans sa quête."
                    ],
                    tcgCards: ["Serena"]
                }
            ],
            7: [
                {
                    name: "Lilith",
                    nameEN: "Lusamine",
                    avatar: "assets/img/dresseurs/lilith.png",
                    role: "Présidente de la Fondation Æther",
                    location: "Alola",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Lilith est la présidente de la Fondation Æther, une organisation qui protège les Pokémon. Cependant, elle est obsédée par les Ultra-Chimères et veut les préserver dans des cristaux. Elle finit par fusionner avec une Ultra-Chimère et devient dangereuse.",
                    lore: "Lilith est une mère qui a perdu son mari dans une dimension alternative. Elle est devenue obsédée par les Ultra-Chimères et veut les préserver pour l'éternité. Elle finit par fusionner avec une Ultra-Chimère et doit être sauvée par le protagoniste.",
                    anecdotes: [
                        "Lilith est la présidente de la Fondation Æther.",
                        "Elle est la mère de Lilie et Gladio.",
                        "Elle est obsédée par les Ultra-Chimères.",
                        "Elle finit par fusionner avec une Ultra-Chimère et devient dangereuse."
                    ],
                    tcgCards: ["Lusamine"]
                },
                {
                    name: "Gladio",
                    nameEN: "Gladion",
                    avatar: "assets/img/dresseurs/gladio.png",
                    role: "Rival",
                    location: "Alola",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Gladio est le fils de Lilith et le frère de Lilie. Il a quitté la Fondation Æther pour protéger son Type:Null. Il est solitaire, déterminé et possède un fort sens de la justice. Il aide le protagoniste à arrêter sa mère.",
                    lore: "Gladio a quitté la Fondation Æther car il ne supportait pas les expériences de sa mère sur les Pokémon. Il a volé un Type:Null pour le protéger et voyage à travers Alola pour devenir plus fort. Il finit par aider le protagoniste à sauver sa mère.",
                    anecdotes: [
                        "Gladio est le fils de Lilith et le frère de Lilie.",
                        "Il a quitté la Fondation Æther pour protéger son Type:Null.",
                        "Il possède un Type:Null qui peut évoluer en Silvallié.",
                        "Il aide le protagoniste à arrêter sa mère."
                    ],
                    tcgCards: ["Gladion"]
                }
            ],
            8: [
                {
                    name: "Rose",
                    nameEN: "Chairman Rose",
                    avatar: "assets/img/dresseurs/rose.png",
                    role: "Président de la Ligue",
                    location: "Galar",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Rose est le président de la Ligue Pokémon de Galar et le propriétaire de Macro Cosmos. Il semble bienveillant au début, mais cache des intentions dangereuses. Il veut réveiller Éthernatos pour résoudre une crise énergétique future, même si cela met le monde en danger.",
                    lore: "Rose est un homme d'affaires puissant qui a construit l'infrastructure de Galar. Il est obsédé par l'idée de résoudre une crise énergétique future et veut réveiller Éthernatos, même si cela met le monde en danger. Il finit par être arrêté par le protagoniste.",
                    anecdotes: [
                        "Rose est le président de la Ligue Pokémon de Galar.",
                        "Il est le propriétaire de Macro Cosmos.",
                        "Il veut réveiller Éthernatos pour résoudre une crise énergétique future.",
                        "Il cache des intentions dangereuses sous une apparence bienveillante."
                    ],
                    tcgCards: ["Chairman Rose"]
                },
                {
                    name: "Nabil",
                    nameEN: "Hop",
                    avatar: "assets/img/dresseurs/nabil.png",
                    role: "Rival",
                    location: "Bourg-en-Vol",
                    specialty: "Divers",
                    socialLinks: {
                        website: "#",
                        twitter: "#",
                        instagram: "#"
                    },
                    history: "Nabil est le frère cadet de Léon, le Champion de Galar, et le rival du protagoniste. Il est énergique, optimiste et rêve de devenir Champion comme son frère. Il commence avec un starter et voyage à travers Galar pour améliorer ses compétences.",
                    lore: "Nabil vit dans l'ombre de son frère Léon, le Champion invaincu de Galar. Il veut prouver qu'il peut être aussi fort que son frère et devenir Champion. Il finit par comprendre que sa vraie passion est la recherche Pokémon et devient l'assistant du Professeur Sorbier.",
                    anecdotes: [
                        "Nabil est le frère cadet de Léon, le Champion de Galar.",
                        "Il commence avec un starter et voyage à travers Galar.",
                        "Il finit par devenir l'assistant du Professeur Sorbier.",
                        "Il comprend que sa vraie passion est la recherche Pokémon."
                    ],
                    tcgCards: ["Hop"]
                }
            ]
        };

        let currentGeneration = 1;
        let trainerCardsCache = new Map();
        
        // Fonction pour obtenir les favoris depuis localStorage
        function getFavorites() {
            const favorites = localStorage.getItem('trainerFavorites');
            return favorites ? JSON.parse(favorites) : [];
        }
        
        // Fonction pour sauvegarder les favoris dans localStorage
        function saveFavorites(favorites) {
            localStorage.setItem('trainerFavorites', JSON.stringify(favorites));
        }
        
        // Fonction pour toggle favori
        function toggleFavorite(nameEN, event) {
            if (event) {
                event.stopPropagation(); // Empêcher le clic sur la carte
            }
            const favorites = getFavorites();
            const index = favorites.indexOf(nameEN);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(nameEN);
            }
            saveFavorites(favorites);
            // Recharger la liste pour mettre à jour les icônes
            const searchValue = document.getElementById('trainer-search')?.value || '';
            loadTrainers(currentGeneration, searchValue);
        }
        
        // Fonction pour vérifier si un dresseur est en favori
        function isFavorite(nameEN) {
            return getFavorites().includes(nameEN);
        }

        function showGeneration(gen) {
            currentGeneration = gen;
            
            // Update active tab
            document.querySelectorAll('.generation-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if (index === gen - 1) {
                    tab.classList.add('active');
                }
            });
            
            // Reset search and load trainers
            const searchInput = document.getElementById('trainer-search');
            if (searchInput) {
                searchInput.value = '';
            }
            loadTrainers(gen, '');
        }

        function loadTrainers(gen, filter = '') {
            const content = document.getElementById('trainers-content');
            const trainers = trainersDatabase[gen] || [];
            
            // Filtrage sur nom, nomEN, rôle ou ville
            const filtered = !filter
                ? trainers
                : trainers.filter(tr =>
                    tr.name.toLowerCase().includes(filter) ||
                    (tr.nameEN && tr.nameEN.toLowerCase().includes(filter)) ||
                    (tr.role && tr.role.toLowerCase().includes(filter)) ||
                    (tr.location && tr.location.toLowerCase().includes(filter))
                );
            
            if (filtered.length === 0) {
                content.innerHTML = `
                    <div class="text-center text-slate-400 py-12">
                        <i class="fas fa-user-slash text-4xl mb-4 opacity-50"></i>
                        <p class="text-lg">Aucun dresseur trouvé pour la recherche.</p>
                    </div>
                `;
                return;
            }
            
            content.innerHTML = filtered.map((trainer, index) => {
                const avatarUrl = trainer.avatar || 'assets/img/dresseurs/default.png';
                const isFav = isFavorite(trainer.nameEN);
                return `
                <div class="trainer-card rounded-2xl p-8 mb-8 scroll-reveal cursor-pointer hover:scale-[1.02] transition-transform" 
                     style="animation-delay: ${index * 0.1}s"
                     onclick="showTrainerProfile('${trainer.nameEN.replace(/'/g, "\\'")}')">
                    <div class="flex flex-col md:flex-row gap-8">
                        <!-- Trainer Info -->
                        <div class="flex-1">
                            <div class="flex items-center gap-4 mb-6">
                                <div class="relative">
                                    <img src="${avatarUrl}" 
                                         alt="Portrait de ${trainer.name}" 
                                         class="trainer-avatar"
                                         onerror="this.src='assets/img/dresseurs/default.png';">
                                    <button onclick="toggleFavorite('${trainer.nameEN.replace(/'/g, "\\'")}', event)" 
                                            class="favorite-btn ${isFav ? 'active' : ''} absolute -top-1 -right-1"
                                            title="${isFav ? 'Retirer des favoris' : 'Ajouter aux favoris'}">
                                        <i class="fas ${isFav ? 'fa-star' : 'fa-star'}"></i>
                                    </button>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-2 flex-wrap">
                                        <h2 class="text-3xl font-bold text-white">${trainer.name}</h2>
                                        <span class="badge-role">${trainer.role}</span>
                                        <span class="badge-specialty">${trainer.specialty}</span>
                                    </div>
                                    <p class="text-slate-400 mb-2">${trainer.location}</p>
                                    ${trainer.socialLinks ? `
                                    <div class="social-links">
                                        ${trainer.socialLinks.website && trainer.socialLinks.website !== '#' ? `
                                            <a href="${trainer.socialLinks.website}" target="_blank" class="social-link" title="Site web">
                                                <i class="fas fa-globe"></i>
                                            </a>
                                        ` : ''}
                                        ${trainer.socialLinks.twitter && trainer.socialLinks.twitter !== '#' ? `
                                            <a href="${trainer.socialLinks.twitter}" target="_blank" class="social-link" title="Twitter">
                                                <i class="fab fa-twitter"></i>
                                            </a>
                                        ` : ''}
                                        ${trainer.socialLinks.instagram && trainer.socialLinks.instagram !== '#' ? `
                                            <a href="${trainer.socialLinks.instagram}" target="_blank" class="social-link" title="Instagram">
                                                <i class="fab fa-instagram"></i>
                                            </a>
                                        ` : ''}
                                    </div>
                                    ` : ''}
                                </div>
                            </div>
                            
                            <!-- History -->
                            <div class="mb-6">
                                <h3 class="text-xl font-bold text-white mb-3 flex items-center">
                                    <i class="fas fa-book mr-2 text-yellow-400"></i>
                                    Histoire
                                </h3>
                                <p class="text-slate-300 leading-relaxed">${trainer.history}</p>
                            </div>
                            
                            <!-- Lore -->
                            <div class="lore-section p-4 rounded-lg mb-6">
                                <h3 class="text-xl font-bold text-white mb-3 flex items-center">
                                    <i class="fas fa-scroll mr-2 text-yellow-400"></i>
                                    Lore
                                </h3>
                                <p class="text-slate-300 leading-relaxed">${trainer.lore}</p>
                            </div>
                            
                            <!-- Anecdotes -->
                            <div class="mb-6">
                                <h3 class="text-xl font-bold text-white mb-3 flex items-center">
                                    <i class="fas fa-lightbulb mr-2 text-yellow-400"></i>
                                    Anecdotes
                                </h3>
                                <div class="space-y-2">
                                    ${trainer.anecdotes.map(anecdote => `
                                        <div class="anecdote-item p-3 rounded-lg">
                                            <p class="text-slate-300 text-sm">• ${anecdote}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <!-- TCG Cards Section -->
                        <div class="md:w-1/3">
                            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                                <i class="fas fa-cards-blank mr-2 text-yellow-400"></i>
                                Cartes TCG
                            </h3>
                            <div id="tcg-cards-${gen}-${index}" class="space-y-4">
                                <div class="text-center text-slate-400 py-4">
                                    <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                    <p class="text-sm">Chargement des cartes...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
            
            // Load TCG cards for each trainer
            filtered.forEach((trainer, index) => {
                if (trainer.tcgCards && trainer.tcgCards.length > 0) {
                    loadTrainerTCGCards(trainer, gen, index);
                } else {
                    const cardContainer = document.getElementById(`tcg-cards-${gen}-${index}`);
                    if (cardContainer) {
                        cardContainer.innerHTML = `
                            <div class="text-center text-slate-500 py-4">
                                <i class="fas fa-info-circle text-xl mb-2"></i>
                                <p class="text-sm">Aucune carte TCG disponible pour ce dresseur.</p>
                            </div>
                        `;
                    }
                }
            });
            
            // Reveal animations
            setTimeout(() => {
                document.querySelectorAll('.scroll-reveal').forEach(el => {
                    el.classList.add('revealed');
                });
            }, 100);
        }

        function showTrainerProfile(nameEN) {
            // Trouve le dresseur dans la DB (nom anglais unique)
            const all = Object.values(trainersDatabase).flat();
            const tr = all.find(t => t.nameEN === nameEN);
            if (!tr) return;

            const content = document.getElementById('trainers-content');
            const searchValue = document.getElementById('trainer-search')?.value || '';
            const avatarUrl = tr.avatar || 'assets/img/dresseurs/default.png';
            const isFav = isFavorite(tr.nameEN);
            
            // Génère le HTML du détail avec animation
            content.innerHTML = `
                <div class="max-w-4xl mx-auto bg-slate-800 rounded-2xl shadow-xl p-8 mt-8 mb-8 profile-transition">
                    <button onclick="loadTrainers(currentGeneration, document.getElementById('trainer-search').value)" 
                            class="text-sm mb-6 text-yellow-400 hover:text-yellow-300 hover:underline flex items-center gap-2">
                        <i class="fas fa-arrow-left"></i> Retour à la liste
                    </button>
                    <div class="flex items-start justify-between gap-6 mb-6">
                        <div class="flex-1">
                            <h1 class="text-4xl md:text-5xl font-extrabold text-yellow-300 mb-2">
                                ${tr.name}
                            </h1>
                            <p class="text-lg text-slate-300 mb-1">
                                ${tr.role} — ${tr.location}
                            </p>
                            <p class="text-sm text-slate-400 font-semibold mb-2">
                                Spécialité : ${tr.specialty}
                            </p>
                            ${tr.socialLinks ? `
                            <div class="social-links justify-start">
                                ${tr.socialLinks.website && tr.socialLinks.website !== '#' ? `
                                    <a href="${tr.socialLinks.website}" target="_blank" class="social-link" title="Site web">
                                        <i class="fas fa-globe"></i>
                                    </a>
                                ` : ''}
                                ${tr.socialLinks.twitter && tr.socialLinks.twitter !== '#' ? `
                                    <a href="${tr.socialLinks.twitter}" target="_blank" class="social-link" title="Twitter">
                                        <i class="fab fa-twitter"></i>
                                    </a>
                                ` : ''}
                                ${tr.socialLinks.instagram && tr.socialLinks.instagram !== '#' ? `
                                    <a href="${tr.socialLinks.instagram}" target="_blank" class="social-link" title="Instagram">
                                        <i class="fab fa-instagram"></i>
                                    </a>
                                ` : ''}
                            </div>
                            ` : ''}
                        </div>
                        <div class="shrink-0 relative">
                            <img src="${avatarUrl}" 
                                 alt="Portrait de ${tr.name}" 
                                 class="trainer-avatar-large"
                                 onerror="this.src='assets/img/dresseurs/default.png';">
                            <button onclick="toggleFavorite('${tr.nameEN.replace(/'/g, "\\'")}', event)" 
                                    class="favorite-btn ${isFav ? 'active' : ''} absolute -top-2 -right-2 text-2xl"
                                    title="${isFav ? 'Retirer des favoris' : 'Ajouter aux favoris'}">
                                <i class="fas ${isFav ? 'fa-star' : 'fa-star'}"></i>
                            </button>
                        </div>
                    </div>
                    <hr class="mb-6 border-slate-600">
                    <div class="mb-5">
                        <strong class="text-yellow-400">Histoire :</strong> 
                        <span class="text-slate-300">${tr.history}</span>
                    </div>
                    <div class="mb-5">
                        <strong class="text-yellow-400">Lore :</strong> 
                        <span class="text-slate-300">${tr.lore}</span>
                    </div>
                    <div class="mb-5">
                        <strong class="text-yellow-400">Anecdotes :</strong>
                        <ul class="list-disc ml-8 text-slate-300 mt-2 space-y-1">
                            ${tr.anecdotes.map(anec => `<li>${anec}</li>`).join('')}
                        </ul>
                    </div>
                    <hr class="mb-6 border-slate-600">
                    <div>
                        <h3 class="text-xl text-white mb-3 flex items-center">
                            <i class="fas fa-cards-blank mr-2 text-yellow-400"></i>Cartes TCG
                        </h3>
                        <div id="trainer-tcg-cards" class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-6">
                            <div class="text-center text-slate-400 py-4">
                                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                <p class="text-sm">Chargement des cartes...</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Charger les cartes TCG pour ce dresseur
            if (tr.tcgCards && tr.tcgCards.length > 0) {
                loadTrainerProfileTCGCards(tr);
            } else {
                document.getElementById('trainer-tcg-cards').innerHTML = `
                    <div class="col-span-full text-center text-slate-500 py-4">
                        <i class="fas fa-info-circle text-xl mb-2"></i>
                        <p class="text-sm">Aucune carte TCG disponible pour ce dresseur.</p>
                    </div>
                `;
            }
        }

        async function loadTrainerTCGCards(trainer, gen, index) {
            const container = document.getElementById(`tcg-cards-${gen}-${index}`);
            const cacheKey = `${trainer.nameEN}-${gen}`;
            
            // Check cache
            if (trainerCardsCache.has(cacheKey)) {
                displayTrainerTCGCards(container, trainerCardsCache.get(cacheKey));
                return;
            }
            
            // Try to load cards for each TCG card name with retry logic
            const allCards = [];
            const maxRetries = 3;
            
            for (const cardName of trainer.tcgCards) {
                let success = false;
                
                for (let attempt = 1; attempt <= maxRetries && !success; attempt++) {
                    try {
                        const apiUrl = `https://api.pokemontcg.io/v2/cards?q=name:"${encodeURIComponent(cardName)}"&pageSize=10`;
                        const timeout = 20000 + (attempt - 1) * 10000; // 20s, 30s, 40s
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), timeout);
                        
                        try {
                            const response = await fetch(apiUrl, {
                                headers: { 'Accept': 'application/json' },
                                signal: controller.signal,
                                mode: 'cors',
                                cache: attempt === 1 ? 'default' : 'no-cache'
                            });
                            
                            clearTimeout(timeoutId);
                            
                            if (response.ok) {
                                const data = await response.json();
                                if (data.data && data.data.length > 0) {
                                    allCards.push(...data.data);
                                    success = true;
                                }
                            } else if (response.status === 504 && attempt < maxRetries) {
                                // Gateway timeout - retry
                                await new Promise(resolve => setTimeout(resolve, 3000));
                                continue;
                            }
                        } catch (fetchError) {
                            clearTimeout(timeoutId);
                            
                            // Détecter erreurs CORS
                            if (fetchError.message && (
                                fetchError.message.includes('CORS') || 
                                fetchError.message.includes('Access-Control-Allow-Origin') ||
                                fetchError.message.includes('Failed to fetch')
                            )) {
                                if (attempt < maxRetries) {
                                    // Attendre plus longtemps pour CORS
                                    await new Promise(resolve => setTimeout(resolve, 5000));
                                    continue;
                                }
                            }
                            
                            // Pour timeout, réessayer
                            if (fetchError.name === 'AbortError' && attempt < maxRetries) {
                                await new Promise(resolve => setTimeout(resolve, 3000));
                                continue;
                            }
                            
                            // Sinon, passer à la carte suivante
                            break;
                        }
                    } catch (error) {
                        // Erreur générale, passer à la carte suivante
                        break;
                    }
                }
            }
            
            if (allCards.length > 0) {
                trainerCardsCache.set(cacheKey, allCards);
                displayTrainerTCGCards(container, allCards);
            } else {
                container.innerHTML = `
                    <div class="text-center text-slate-500 py-4">
                        <i class="fas fa-info-circle text-xl mb-2"></i>
                        <p class="text-sm">Aucune carte TCG trouvée pour ce dresseur.</p>
                        <p class="text-xs text-slate-600 mt-1">Cela peut être dû à une erreur CORS temporaire.</p>
                    </div>
                `;
            }
        }

        function displayTrainerTCGCards(container, cards) {
            // Remove duplicates by card ID
            const uniqueCards = Array.from(new Map(cards.map(card => [card.id, card])).values());
            
            container.innerHTML = `
                <div class="grid grid-cols-2 gap-3">
                    ${uniqueCards.slice(0, 6).map(card => {
                        const largeImage = card.images?.large || card.images?.small || '';
                        const smallImage = card.images?.small || '';
                        const cardName = (card.name || '').replace(/'/g, "\\'");
                        const cardSet = ((card.set?.name || '')).replace(/'/g, "\\'");
                        const cardRarity = ((card.rarity || '')).replace(/'/g, "\\'");
                        return `
                        <div class="tcg-card rounded-lg p-2 cursor-pointer tcg-card-item" 
                             data-image="${encodeURIComponent(largeImage)}"
                             data-name="${encodeURIComponent(cardName)}"
                             data-set="${encodeURIComponent(cardSet)}"
                             data-rarity="${encodeURIComponent(cardRarity)}">
                            <img src="${smallImage}" 
                                 alt="${card.name}" 
                                 class="w-full h-auto rounded"
                                 onerror="this.src='https://via.placeholder.com/245x342/1e293b/ffffff?text=${encodeURIComponent(card.name)}'">
                            <p class="text-white text-xs mt-2 truncate">${card.name}</p>
                            <p class="text-slate-400 text-xs">${card.set?.name || ''}</p>
                        </div>
                    `;
                    }).join('')}
                </div>
                ${uniqueCards.length > 6 ? `
                    <p class="text-slate-400 text-xs text-center mt-2">+ ${uniqueCards.length - 6} autres cartes</p>
                ` : ''}
            `;
            
            // Ajouter les event listeners pour ouvrir la modal
            container.querySelectorAll('.tcg-card-item').forEach(cardElement => {
                cardElement.addEventListener('click', function() {
                    const imageUrl = decodeURIComponent(this.dataset.image);
                    const name = decodeURIComponent(this.dataset.name);
                    const set = decodeURIComponent(this.dataset.set);
                    const rarity = decodeURIComponent(this.dataset.rarity);
                    openCardModal({
                        imageLarge: imageUrl,
                        name: name,
                        setName: set,
                        rarity: rarity
                    });
                });
            });
        }

        async function loadTrainerProfileTCGCards(trainer) {
            const container = document.getElementById('trainer-tcg-cards');
            const cacheKey = `${trainer.nameEN}-profile`;
            
            // Check cache
            if (trainerCardsCache.has(cacheKey)) {
                displayTrainerProfileTCGCards(container, trainerCardsCache.get(cacheKey));
                return;
            }
            
            // Try to load cards for each TCG card name with retry logic
            const allCards = [];
            const maxRetries = 2;
            
            for (const cardName of trainer.tcgCards) {
                let success = false;
                
                for (let attempt = 1; attempt <= maxRetries && !success; attempt++) {
                    try {
                        const apiUrl = `https://api.pokemontcg.io/v2/cards?q=name:"${encodeURIComponent(cardName)}"&pageSize=10`;
                        const timeout = 20000;
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), timeout);
                        
                        try {
                            const response = await fetch(apiUrl, {
                                headers: { 'Accept': 'application/json' },
                                signal: controller.signal,
                                mode: 'cors'
                            });
                            
                            clearTimeout(timeoutId);
                            
                            if (response.ok) {
                                const data = await response.json();
                                if (data.data && data.data.length > 0) {
                                    allCards.push(...data.data);
                                    success = true;
                                }
                            }
                        } catch (fetchError) {
                            clearTimeout(timeoutId);
                            if (fetchError.name === 'AbortError' && attempt < maxRetries) {
                                await new Promise(resolve => setTimeout(resolve, 3000));
                                continue;
                            }
                            break;
                        }
                    } catch (error) {
                        break;
                    }
                }
            }
            
            if (allCards.length > 0) {
                trainerCardsCache.set(cacheKey, allCards);
                displayTrainerProfileTCGCards(container, allCards);
            } else {
                container.innerHTML = `
                    <div class="col-span-full text-center text-slate-500 py-4">
                        <i class="fas fa-info-circle text-xl mb-2"></i>
                        <p class="text-sm">Aucune carte TCG trouvée pour ce dresseur.</p>
                    </div>
                `;
            }
        }

        function displayTrainerProfileTCGCards(container, cards) {
            // Remove duplicates by card ID
            const uniqueCards = Array.from(new Map(cards.map(card => [card.id, card])).values());
            
            container.innerHTML = uniqueCards.map(card => {
                const largeImage = card.images?.large || card.images?.small || '';
                const smallImage = card.images?.small || '';
                const cardName = (card.name || '').replace(/'/g, "\\'");
                const cardSet = ((card.set?.name || '')).replace(/'/g, "\\'");
                const cardRarity = ((card.rarity || '')).replace(/'/g, "\\'");
                return `
                    <div class="tcg-card rounded-lg p-2 cursor-pointer tcg-card-item" 
                         data-image="${encodeURIComponent(largeImage)}"
                         data-name="${encodeURIComponent(cardName)}"
                         data-set="${encodeURIComponent(cardSet)}"
                         data-rarity="${encodeURIComponent(cardRarity)}">
                        <img src="${smallImage}" 
                             alt="${card.name}" 
                             class="w-full h-auto rounded"
                             onerror="this.src='https://via.placeholder.com/245x342/1e293b/ffffff?text=${encodeURIComponent(card.name)}'">
                        <p class="text-white text-xs mt-2 truncate">${card.name}</p>
                        <p class="text-slate-400 text-xs">${card.set?.name || ''}</p>
                    </div>
                `;
            }).join('');
            
            // Ajouter les event listeners pour ouvrir la modal
            container.querySelectorAll('.tcg-card-item').forEach(cardElement => {
                cardElement.addEventListener('click', function() {
                    const imageUrl = decodeURIComponent(this.dataset.image);
                    const name = decodeURIComponent(this.dataset.name);
                    const set = decodeURIComponent(this.dataset.set);
                    const rarity = decodeURIComponent(this.dataset.rarity);
                    openCardModal({
                        imageLarge: imageUrl,
                        name: name,
                        setName: set,
                        rarity: rarity
                    });
                });
            });
        }

        // Sélecteurs de la modal (une seule fois)
        let cardModalOverlay, cardModalImg, cardModalName, cardModalSet, cardModalRarity, cardModalClose;

        // Ouvrir la modal avec les infos d'une carte
        function openCardModal({ imageLarge, name, setName, rarity }) {
            if (!cardModalOverlay || !cardModalImg) {
                console.error('Modal not initialized!');
                return;
            }

            cardModalImg.src = imageLarge || '';
            cardModalImg.alt = name || 'Carte Pokémon';
            if (cardModalName) cardModalName.textContent = name || 'Carte inconnue';
            if (cardModalSet) cardModalSet.textContent = setName ? `Set : ${setName}` : 'Set inconnu';
            if (cardModalRarity) cardModalRarity.textContent = rarity ? `Rareté : ${rarity}` : '';

            cardModalOverlay.classList.add('is-open');
            document.body.style.overflow = 'hidden'; // bloque le scroll en fond
        }

        // Fermer la modal
        function closeCardModal() {
            if (cardModalOverlay) {
                cardModalOverlay.classList.remove('is-open');
                document.body.style.overflow = '';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialiser les sélecteurs de la modal
            cardModalOverlay = document.getElementById('card-modal-overlay');
            cardModalImg = document.getElementById('card-modal-img');
            cardModalName = document.getElementById('card-modal-name');
            cardModalSet = document.getElementById('card-modal-set');
            cardModalRarity = document.getElementById('card-modal-rarity');
            cardModalClose = document.getElementById('card-modal-close');

            if (!cardModalOverlay || !cardModalImg) {
                console.error('Modal elements not found!');
            } else {
                // Bouton ×
                if (cardModalClose) {
                    cardModalClose.addEventListener('click', closeCardModal);
                }

                // Clic en dehors de la boîte (sur l'overlay)
                cardModalOverlay.addEventListener('click', (event) => {
                    if (event.target === cardModalOverlay) {
                        closeCardModal();
                    }
                });

                // Touche Échap
                window.addEventListener('keydown', (event) => {
                    if (event.key === 'Escape' || event.key === 'Esc') {
                        if (cardModalOverlay && cardModalOverlay.classList.contains('is-open')) {
                            closeCardModal();
                        }
                    }
                });
            }
            
            // Barre de recherche
            const searchInput = document.getElementById('trainer-search');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    const term = searchInput.value.trim().toLowerCase();
                    loadTrainers(currentGeneration, term);
                });
            }
            
            loadTrainers(1);
            
            // Scroll reveal
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                    }
                });
            }, { threshold: 0.1 });
            
            document.querySelectorAll('.scroll-reveal').forEach(el => {
                observer.observe(el);
            });
        });
    </script>
</body>
</html>

